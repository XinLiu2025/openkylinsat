FormatVer: 20220411
Id: CVE-2021-22555
Belong: kernel
PocHazardLevel: low
Source: https://github.com/veritas501/CVE-2021-22555-PipeVersion
SiteInfo:
    Name: Linux kernel是美国Linux基金会的开源操作系统Linux所使用的内核
    Severity: high
    Solution: https://github.com/google/security-research/security/advisories/GHSA-xxx5-8mvq-3528
    Description:
        Linux Netfilter模块在实现IPT_SO_SET_REPLACE（或IP6T_SO_SET_REPLACE）setsockopt时，存在堆越界写入漏洞。该漏洞将允许本地用户通过用户名空间获取权限提升，在kCTF中被用于攻击Kubernetes Pod容器，实现容器逃逸。该漏洞已在Linux内核代码中存在15年。
    ScopeOfInfluence:
        v2.6.19-rc1~v5.12-rc7
    References:
        - http://www.cnnvd.org.cn/home/globalSearch?keyword=CVE-2021-22555
        - https://nvd.nist.gov/vuln/detail/CVE-2021-22555
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 7.8
        CveId: CVE-2021-22555
        CweId: CWE-787
        CnvdId: None
        KveId: None
    Tags:
        - ve2021
        - 权限提升
        - 容器逃逸
SiteRequests:
    Implement: 
        RawTypes:
            - implementOne
        ImArray:
            - Inter:
              InterArgs :    
              Exec : CVE-2021-22555_x86_64
              Args :
        ExpireTime: 30      #second
        Inter:
            - ">.:exploit success"   #等待输出'infinitely ...'
            - "<<:id"    #输入'id'
            - ">.:\n"      #等待输出'\n'
            - ">?:uid=0(root)" #判断输出为'uid=0(root)'为成功
        Condition: None
    ReqCondition: true
    Matchers:
        Types:
            - dsl
        MatcherMap: 
            dsl: check os
        Condition: None
