FormatVer: 20220129
Id: CVE-2022-24122
Belong: kernel
PocHazardLevel: high
Source: https://github.com/meowmeowxw/CVE-2022-24122.git
SiteInfo:
    Name: Linux kernel是美国Linux基金会的开源操作系统Linux所使用的内核
    Severity: high
    Solution: https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=f9d87929d451d3e649699d0f1d74f71f77ad38f5
    Description:
       Linux kernel 5.14至5.16.4版本存在内存错误引用漏洞，该漏洞源于名称空间被禁用后，ucounts对象依然存在。当非权限用户的名称空间被启用时，攻击者可利用该漏洞提升权限。
    ScopeOfInfluence:
        v5.14-v5.16.4
    References:
        - https://www.openwall.com/lists/oss-security/2022/01/29/1
        - https://avd.aliyun.com/detail?id=AVD-2022-24122
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 7.8
        CveId: CVE-2022-24122
        CweId: CWE-416
        CnvdId: None
        KveId: None
    Tags:
        - 权限提升
SiteRequests:
    Implement: 
        RawTypes:
            - implementOne
        ImArray:
            - Inter:
              InterArgs :    
              Exec : exploit
              Args :
        ExpireTime: 30      #second
        Inter:
            - "[!] DESTROYED SHARED MEMORY\n"   #等待输出
            - "<<:whoami"    #输入'id\n'
            - ">.:\n"      #等待输出'\n'
            - ">?:root" 
        Condition: None
