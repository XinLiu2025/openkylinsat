FormatVer: 20230327
Id: CVE-2019-18634
Belong: system
PocHazardLevel: low
Source: https://github.com/edsonjt81/sudo-cve-2019-18634
SiteInfo:
    Name: Sudo是一款使用于类Unix系统的，允许用户通过安全的方式使用特殊的权限执行命令的程序
    Severity: high
    Solution: https://www.sudo.ws/alerts/pwfeedback.html
    Description:
        在 1.8.26 之前的 Sudo 中，如果在 /etc/sudoers 中启用 pwfeedback，用户可以在特权 sudo 进程中触发基于堆栈的缓冲区溢出。（pwfeedback 是 Linux Mint 和 elementary OS 的默认设置；然而，它不是上游和许多其他包的默认设置，并且只有在管理员启用时才会存在。）攻击者需要向标准输入传递一个长字符串tgetpass.c 中的 getln()。权套接字API并获得管理员特权。
    ScopeOfInfluence:
        sudo < 1.8.26
    References:
        - https://www.sudo.ws/alerts/pwfeedback.html
        - https://nvd.nist.gov/vuln/detail/CVE-2019-18634
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 7.8
        CveId: CVE-2019-18634
        CweId: CWE-787
        CnvdId: None
        KveId: None
    Tags:
        - 堆缓冲区溢出漏洞
        - 权限提升
SiteRequests:
    Implement: 
        ImArray:
            - Inter : python3
              InterArgs :
              Exec : CVE-2019-18634.py
              Args : 
        ExpireTime: 20

        # < input
        # > output 
        # . wait
        # ? condition
        # : content
        #
        #组合起来
        # >. 等待直到输出 
        # << 输入字符
        # >?判断条件
        Inter:
            - ">.:interactive mode"  
            - "<<:whoami"
            - ">.:\n"
            - ">?:root" #ture
        Condition: None
