FormatVer: 20190423
Id: CVE-2019-7304
Belong: system
PocHazardLevel: critical
Source: https://github.com/initstring/dirty_sock
SiteInfo:
    Name: snap是一个Linux系统上的包管理软件。在Ubuntu18.04后默认预安装到了系统中。
    Severity: critical
    Solution: https://usn.ubuntu.com/3887-1/
    Description:
        snapd 2.28到2.37错误地验证并解析了远程套接字在UNIX套接字上执行访问控制时的地址。一个本地攻击者可以使用它来访问特权套接字API并获得管理员特权。
    ScopeOfInfluence:
        Snapd < 2.37.1
        Ubuntu_linux 14.04 LTS
        Ubuntu_linux 16.04 LTS
        Ubuntu_linux 18.04 LTS
        Ubuntu_linux 18.10
    References:
        - https://usn.ubuntu.com/3887-1/
        - https://www.exploit-db.com/exploits/46361
        - https://www.exploit-db.com/exploits/46362
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 9.8
        CveId: CVE-2019-7304
        CweId: CWE-863
        CnvdId: None
        KveId: None
    Tags:
        - 授权机制不正确
        - snapd提权
SiteRequests:
    Implement: 
        ImArray:
            - Inter : python3
              InterArgs :
              Exec : CVE-2019-7304.py
              Args : None
        ExpireTime: 10

        # < input
        # > output 
        # . wait
        # ? condition
        # : content
        #
        #组合起来
        # >. 等待直到输出 
        # << 输入字符
        # >?判断条件
        Inter:
            - ">?:Success! You can now `su`" #ture
        Condition: None
