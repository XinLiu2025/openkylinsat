FormatVer: 20230307
Id: CVE-2021-3156
Belong: system
PocHazardLevel: low
Source: https://github.com/worawit/CVE-2021-3156
SiteInfo:
    Name: Sudo 是一个用于类 Unix 计算机操作系统的程序，它能够使用户能够以另一个用户（默认是超级用户）的安全权限运行程序。sudoedit 功能用于以另外一个用户身份编辑文件。
    Severity: high
    Solution: https://vigilance.fr/vulnerability/libarchive-write-access-via-Symlink-Modes-Times-Flags-Modification-37590
    Description:
        Sudo before 1.9.5p2 存在缓冲区错误漏洞，攻击者可使用sudoedit -s和一个以单个反斜杠字符结束的命令行参数升级到root。
    ScopeOfInfluence:
        小于1.9.5p2
    References:
        - https://nvd.nist.gov/vuln/detail/CVE-2021-3156
        - http://packetstormsecurity.com/files/161160/Sudo-Heap-Based-Buffer-Overflow.html
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 7.8
        CveId: CVE-2021-3156
        CweId: CWE-193
        CnvdId: None
        KveId: None
    Tags:
        - cve2021
        - 权限提升
        - 堆缓冲区溢出漏洞
SiteRequests:
    Implement: 
        ImArray:
            - Inter :
              InterArgs :
              Exec : CVE-2021-3156.sh
              Args : 
        ExpireTime: 10
        # < input
        # > output 
        # . wait
        # ? condition
        # : content
        #
        #组合起来
        # >. 等待直到输出 
        # << 输入字符
        # >?判断条件
        Inter:
            - ">?:sudoedit; /: not a regular file"
        Condition: None
