FormatVer: 20210604
Id: CVE-2021-3490
Belong: kernel
PocHazardLevel: low
Source: https://github.com/chompie1337/Linux_LPE_eBPF_CVE-2021-3490
SiteInfo:
    Name: Linux kernel是美国Linux基金会的开源操作系统Linux所使用的内核。
    Severity: high
    Description:
        利用此漏洞可实现本地权限提升，该漏洞是由于Linux内核中按位操作（AND、OR 和 XOR）的 eBPF ALU32 边界跟踪没有正确更新 32 位边界，造成 Linux 内核中的越界读取和写入，从而导致任意代码执行。
    ScopeOfInfluence:
        5.10.37 ≤ linux-kernel ≤ 5.13
    References:
      - https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=049c4e13714ecbca567b4d5f6d563f05d431c80e
      - https://security.netapp.com/advisory/ntap-20210716-0004/
      - https://ubuntu.com/security/notices/USN-4949-1
      - https://ubuntu.com/security/notices/USN-4950-1
      - https://www.openwall.com/lists/oss-security/2021/05/11/11
      - https://www.zerodayinitiative.com/advisories/ZDI-21-606/
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 7.8
        CveId: CVE-2021-3490
        CweId: CWE-20, CWE-125, CWE-787
        CnvdId: None
        KveId: None
    Tags:
        - cve2021
        - 读写越界
SiteRequests:
    Implement: 
        RawTypes:
            - implementOne
        ImArray:
            - inter: 
              InterArgs :    
              Exec : bin/exploit.bin
              Args :
        ExpireTime: 15
        Inter:
            - ">.:[+] success! enjoy r00t :)!" 
            - "<<:id\n"    #输入'id\n'
            - ">.:\n"      #等待输出'\n'
            - ">?:uid=0(root)" #判断输出为'uid=0(root)'为成功
        Condition: None
