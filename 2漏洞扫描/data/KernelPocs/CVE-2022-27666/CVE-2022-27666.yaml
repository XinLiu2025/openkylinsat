FormatVer: 20220323
Id: CVE-2022-27666
Belong: kernel
PocHazardLevel: high
Source: https://github.com/plummm/CVE-2022-27666
SiteInfo:
    name: Linux kernel是美国Linux基金会的开源操作系统Linux所使用的内核。
    severity: high
    description: 
        Linux kernel 5.16.15之前版本存在安全漏洞，该漏洞源于net/ipv4/esp4.c 和 net/ipv6/esp6.c 中IPsec ESP 代码存在缓冲区溢出。本地攻击者可利用该漏洞通过覆盖内核堆对象获得特权。
    ScopeOfInfluence:
        ~ linux kernel 5.17-rc5
    Reference:
        - https://bugzilla.redhat.com/show_bug.cgi?id=2061633
        - https://github.com/torvalds/linux/commit/ebe48d368e97d007bfeb76fcb065d6cfc4c96645
        - https://security.netapp.com/advisory/ntap-20220429-0001/
        - https://www.debian.org/security/2022/dsa-5127
        - https://www.debian.org/security/2022/dsa-5173
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 7.8
        CveId: CVE-2022-27666
        CweId: CWE-787
        CnvdId: None
        KveId: None
    Tags: 
        - 缓冲区溢出
        - 权限提升
        - cve2022
SiteRequests:
    Implement: 
        RawTypes:
            - implementOne
        ImArray:
            - inter: bash
              InterArgs :    
              Exec : run.sh
              Args :
        ExpireTime: 30      #second
        Inter:
            - ">.:[+] I AM ROOT!"   #等待输出
            - "<<:whoami\n"    #输入'id\n'
            - ">.:\n"      #等待输出'\n'
            - ">?:root" #判断输出为'root'为成功
        Condition: None

