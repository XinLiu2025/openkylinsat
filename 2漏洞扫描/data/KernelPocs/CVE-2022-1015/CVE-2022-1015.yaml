Id: CVE-2021-1015
Belong: kernel
PocHazardLevel: low
Source: https://github.com/pqlx/CVE-2022-1015
SiteInfo:
    Name: Linux kernel 安全漏洞
    Severity: medium
    Description:
        Linux 内核存在安全漏洞，该漏洞源于在netfilter子系统的linux/net/netfilter/nf_tables_api.c中存在Linux内核的一个缺陷。 此漏洞允许本地用户导致越界写入问题。 攻击者可以通过nft_expr_payload触发 Linux 内核的内存损坏，从而触发拒绝服务，并可能运行代码。
    Scope-of-influence:
        v5.12~v5.17
    References:
        - http://blog.dbouman.nl/2022/04/02/How-The-Tables-Have-Turned-CVE-2022-1015-1016/	
        - http://packetstormsecurity.com/files/169951/Kernel-Live-Patch-Security-Notice-LSN-0090-1.html
        - http://www.openwall.com/lists/oss-security/2022/08/25/2
        - http://www.openwall.com/lists/oss-security/2023/01/13/2
        - http://www.openwall.com/lists/oss-security/2023/02/23/1
        - https://bugzilla.redhat.com/show_bug.cgi?id=2065323
        - https://seclists.org/oss-sec/2022/q1/205
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H
        CvssScore: 6.6
        CveId: CVE-2021-1015
        CweId: CWE-787
        CnvdId: None
        KveId: None
    Tags:
        - 越界
SiteRequests:
    Implement: 
        ImArray:
            - inter:
              InterArgs :    
              Exec : pwn
              Args :
        ExpireTime: 30      #second
        Inter:
            - ">.:[+] Press enter for root shell.."   #等待输出'[+] Press enter for root shell..'
            - "<<:\n"    #输入'\n'
            - "<<:whoami\n"    #输入'id\n'
            - ">?:root" #判断输出为'uid=0(root) gid=0(root) groups=0(root)'为成功
        Condition: None
    ReqCondition: true
    Matchers:
        Types:
            - dsl
        MatcherMap: 
            dsl: check os
        Condition: None
