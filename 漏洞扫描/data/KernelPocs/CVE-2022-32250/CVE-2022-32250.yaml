FormatVer: 20220602
Id: CVE-2022-32250
Belong: kernel
PocHazardLevel: high
Source: https://github.com/theori-io/CVE-2022-32250-exploit
SiteInfo:
    Name: Linux kernel是美国Linux基金会的开源操作系统Linux所使用的内核
    Severity: high
    Solution: https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/net/netfilter?id=520778042ccca019f3ffa136dd0ca565c486cedd
    Description:
       Linux kernel 5.18.1版本及之前版本存在安全漏洞，该漏洞源于net/netfilter/nf_tables_api.c允许本地用户将权限升级为root用户，攻击者利用该漏洞可导致释放后重用。
    ScopeOfInfluence:
        kernel(<=5.18.1s)
    References:
        - https://www.openwall.com/lists/oss-security/2022/05/31/1
        - https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/net/netfilter?id=520778042ccca019f3ffa136dd0ca565c486cedd
        - http://www.openwall.com/lists/oss-security/2022/06/03/1
        - http://www.openwall.com/lists/oss-security/2022/06/04/1
        - https://www.debian.org/security/2022/dsa-5161
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UIZTJOJCVVEJVOQSCHE6IJQKMPISHQ5L/
        - https://bugzilla.redhat.com/show_bug.cgi?id=2092427
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MO6Y3TC4WUUNKRP7OQA26OVTZTPCS6F2/
        - http://www.openwall.com/lists/oss-security/2022/06/20/1
        - https://lists.debian.org/debian-lts-announce/2022/07/msg00000.html
        - http://www.openwall.com/lists/oss-security/2022/07/03/6
        - http://www.openwall.com/lists/oss-security/2022/07/03/5
        - https://www.debian.org/security/2022/dsa-5173
        - https://security.netapp.com/advisory/ntap-20220715-0005/
        - http://www.openwall.com/lists/oss-security/2022/08/25/1
        - https://github.com/theori-io/CVE-2022-32250-exploit
        - https://blog.theori.io/research/CVE-2022-32250-linux-kernel-lpe-2022/
        - http://www.openwall.com/lists/oss-security/2022/09/02/9
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 7.8
        CveId: CVE-2022-32250
        CweId: CWE-416
        CnvdId: None
        KveId: None
    Tags:
        - 权限提升
        - cve2022
        - 释放后使用
SiteRequests:
    Implement: 
        ImArray:
            - Inter:
              InterArgs :    
              Exec : exp
              Args :
        ExpireTime: 30      #second

        # < input
        # > output 
        # . wait
        # ? condition
        # : content
        #
        #组合起来
        # >. 等待直到输出 
        # << 输入字符
        # >?判断条件
        Inter:
            - ">.:I am root"   #等待输出
            - "<<:whoami"    #输入'whoami\n'
            - ">.:\n"      #等待输出'\n'
            - ">?:root" #判断输出为'root'为成功
        Condition: None
