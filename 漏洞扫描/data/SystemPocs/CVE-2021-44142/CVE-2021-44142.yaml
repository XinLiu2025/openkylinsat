FormatVer: 20230222
Id: CVE-2021-44142
Belong: system
PocHazardLevel: low
Source: https://github.com/horizon3ai/CVE-2021-44142
SiteInfo:
    Name: Samba是在Linux和UNIX系统上实现SMB协议的一个免费软件，由服务器及客户端程序构成。SMB(Server Messages Block，信息服务块)是一种在局域网上共享文件和打印机的一种通信协议，它为局域网内的不同计算机之间提供文件及打印机等资源的共享服务。
    Severity: high
    Solution: https://www.samba.org/samba/security/CVE-2021-44142.html
    Description:
        Samba官方发布安全公告，4.13.17之前的所有Samba 版本中存在一个代码执行漏洞（CVE-2021-44142），该漏洞存在于Samba中vfs_fruit模块的默认配置中，在smbd解析EA元数据时，对文件扩展属性具有写访问权限的远程攻击者（可以是guest或未认证用户）可越界写入并以root身份执行任意代码。
    ScopeOfInfluence:
        4.13.x < Samba < 4.13.17
        4.14.x < Samba < 4.14.12
        4.15.x < Samba < 4.15.5
    References:
        - https://www.samba.org/samba/security/CVE-2021-44142.html
        - https://nvd.nist.gov/vuln/detail/CVE-2021-44142
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A
        CvssScore: 8.8
        CveId: CVE-2021-44142
        CweId: CWE-125,CWE-787
        CnvdId: None
        KveId: None
    Tags:
        - RCE
        - Samba
SiteRequests:
    Implement: 
        ImArray:
            - Inter : python3
              InterArgs :
              Exec : CVE-2021-44142.py
              Args : 
                - "127.0.0.1"
                - "445"
                - TimeMachineBackup
                - root
        ExpireTime: 10

        # < input
        # > output 
        # . wait
        # ? condition
        # : content
        #
        #组合起来
        # >. 等待直到输出 
        # << 输入字符
        # >?判断条件
        Inter:
            - '>?:successful' #ture
        Condition: None
