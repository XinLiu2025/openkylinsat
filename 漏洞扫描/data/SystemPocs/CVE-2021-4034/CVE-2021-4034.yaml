FormatVer: 20230306
Id: CVE-2021-4034
Belong: system
PocHazardLevel: low
Source: https://github.com/berdav/CVE-2021-4034
SiteInfo:
    Name: Polkit（PolicyKit）是类Unix系统中一个应用程序级别的工具集，通过定义和审核权限规则，实现不同优先级进程间的通讯。pkexec是Polkit开源应用框架的一部分，可以使授权非特权用户根据定义的策略以特权用户的身份执行命令。
    Severity: high
    Solution: https://access.redhat.com/security/cve/cve-2021-4034
    Description:
        polkit pkexec 中对命令行参数处理有误，导致参数注入，能够导致本地提权。pkexec应用程序为Linux系统预装工具，攻击者可通过构造特定的参数诱导pkexec执行任意代码，从而获取本地管理员权限。
    ScopeOfInfluence:
        2009年5月至2022年1月发布的所有 Polkit 版本
    References:
        - https://nvd.nist.gov/vuln/detail/CVE-2021-4034
        - http://packetstormsecurity.com/files/166196/Polkit-pkexec-Local-Privilege-Escalation.html
    SiteClassification:
        CvssMetrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
        CvssScore: 7.8
        CveId: CVE-2021-4034
        CweId: CWE-787,CWE-125
        CnvdId: None
        KveId: None
    Tags:
        - cve2021
        - 权限提升
SiteRequests:
    Implement: 
        ImArray:
            - Inter : python3
              InterArgs :
              Exec : CVE-2021-4043.py
              Args : 
        ExpireTime: 10

        # < input
        # > output 
        # . wait
        # ? condition
        # : content
        #
        #组合起来
        # >. 等待直到输出 
        # << 输入字符
        # >?判断条件
        Inter:
            - ">.:[+] Calling execve()"  #ture
            - "<<:whoami"
            - ">.:\n"      #等待输出'\n'
            - ">?:root" 
        Condition: None
